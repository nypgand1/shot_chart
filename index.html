<!DOCTYPE html>
<html>
    
    <head>
        <meta charset="utf-8">
        <title>Shopping Mall Messing</title>
        <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    </head>
    
    <body>
        <div id="shot_chart"></div>
    </body>
    
    <script type="text/javascript">
    var width = 652,
        height = 613;
    
    var svg = d3.select("#shot_chart").append("svg")
        .attr("width", width)
        .attr("height", height);
   
    var image = svg.append("svg:image")
        .attr("xlink:href", "http://stats.nba.com/media/shotchart_background_zone_652.png")
        .attr("width", width)
        .attr("height", height);

    var xScale = d3.scale.linear()
        .domain([0, 500])
        .range([0, width]);
    
    var yScale = d3.scale.linear()
        .domain([-200, -500])
        .range([height, 0]);
    
    var pavement = d3.svg.line()
        .interpolate("linear")
        .x(function(d) {
            return xScale(d[0]);
        })
        .y(function(d) {
            return yScale(d[1]);
        })
    
    d3.json("shoppingMall.json", function(error, jsonData) {
        var color1 = d3.scale.category10();
    
        svg.selectAll("g")
            .data(jsonData.features)
            .enter()
            .append("g");

        svg.selectAll("g")
            .append("path")
                .attr("d", function(d, i) {
                    return pavement(d.geometry.coordinates[0]);
                })
                .attr("text", function(d, i) {
                    return d.properties.ID + ' ' + d.properties.ShopName;
                })
                .attr("fill", function(d, i) {
                    return color1(i);
                })
                .attr("fill-opacity", 0.5);

        svg.selectAll("g").selectAll("text")
            .data(function(d) {
                return d.geometry.coordinates[0];
            })
            .enter()
            .append("text");

        svg.selectAll("text")
                //.attr("dy", ".3em")
                .attr("x", function(d) {
                    return xScale(d[0]);
                })
                .attr("y", function(d) {
                    return yScale(d[1]);
                })
                //.style("text-anchor", "middle")
                .text(function(d) {
                    return xScale(d[0]);
                });
    
    });
    </script>
    
</html>
